# NGX Code Guard

Table of Contents
=================

   * [Features](#features)
   * [Installation](#installation)
   * [New Projects](#new-projects)
   * [Existing projects](#existing-projects)
   * [Usage](#usage)
   * [Bugs, features, feedback](#bugs-features-feedback)

This is an Angular schematic which aims to improve code quality in general by installing several useful code checkers, validators and and other automated dev tools. 

The goal of this project is to collect all the best code quality control tools / dev tools in one package to provide a way to seamlessly integrate "best practices" into any Angular app.

### Features

By default, the package does the following.:

- Installs the linter of your choice (TsLint or EsLint).
- Configures the TypeScript / Javascript linter using strict linting rules.
- Installs JSONLint to validate JSON files
- Installs StyleLint to validate style files (SCSS, CSS, SASS or LESS).
- Configures Git pre-commit hooks for all code (TS, JS, CSS / SCSS, JSON, MD)
- Optimizes TypeScript compiler config by enabling all strict checks.
- Installs and configures Prettier code formatter.
- Automatically formats all staged files using Prettier.
- Installs and configures webpack bundle analyzer.
- Installs and configures commitlint to enforce commit message conventions.
- Installs and configures Compodoc documentation generator.
- Installs all dependencies using the package manager of your choice.
- Generates NPM scripts for all tools. 

Additionally, this tool also can do the following (and by default, it will):

- Installs and configures Cypress for E2E testing. This comes with: 
    - TypeScript support, 
    - Test coverage reports (HTML, text and other formats)
    - Automatic network mocking
    - A11Y plugins for accessibility E2E testing. 
- Installs and configures Istanbul test coverage reporter.
- Adds automated A11Y (WCAG 2.x or Section 508) accessibility checkers.
- Installs and configures Markdownlint for MD validation.


### Installation

You can easily use this with Angular CLI.

```bash
ng add ngx-code-guard

or

npm i ngx-code-guard --save-dev
```

### New Projects

You may generate a new Angular project with all the above extras buy running:

```bash
ng new -c ngx-code-guard --name projectName [options]
```

... where "options" means any option you would normally pass to "ng new".


### Existing projects

To add these tools to an existing project, run the following:


```bash
ng g ngx-code-guard:guard 
```

### Usage

You may customize the behavior of this tool using various command line options. Almost all of these have meaningful default values, thus in most cases you won't need to override these. However, should you feel the need for it, you may override any flag. Run the command below for a list of all available options.

```bash
ng g ngx-code-guard:guard --help

or

ng new -c ngx-code-guard --help
```

Once the package is installed, in addition to the tools and features described above, you will also have the following useful NPM scripts installed.
Just execute npm run CMD or yarn CMD to run them:

| Command  | Description |
| -------- | ------------- |
| docs:build  | Builds HTML docs using Compodoc  |
| docs:show  | Opens HTML docs generated by Compodoc using the default browser |
| e2e:headless  | Runs Cypress tests in headless chrome and prints results to console |
| e2e:manual  | Starts up the Cypress test runner app, so you can run test suites manually |
| e2e:all  | Runs Cypress tests in Chrome automatically (executes all test suites) |
| e2e:report:text  | Generates E2E test coverage reports in text format and prints it to console |
| e2e:report:html  | Generates E2E test coverage reports in HTML format and loads it up using the default browser |
| e2e:report:summary  | Generates short summary report in text format and prints it to console |
| analyze  | Starts webpack bundle analyzer  |

- **analyze** requires ./stats.json to exist in the project directory. You can generate that using **ng new**.

#### Test coverage reports

You may run any of the **e2e:headless, e2e:manual or e2e:all** commands with the **-e coverage=true** flag. This will generate test coverage report which you can view in text and HTML formats. For example, to the view the HTML report, run the following:

```bash
npm run e2e:all -- -e coverage=true

or

yarn e2e:all -e coverage=true
```

It is also possible to generate reports in various different formats. 

```bash
npx nyc report --reporter=REPORTER_NAME
```

For a list of available reporters, please see the [this page](https://istanbul.js.org/docs/advanced/alternative-reporters/).


#### Automatic request caching

It is possible to cache network requests, so your app needs to perform them only once and after that each request will be served from the local cache. This can greatly speed up your tests. Enable this by changing the following option in  **cypress.json**: 

```javascript
"autorecord": { "forceRecord": true }
```
Run your tests now and network requests will be recorded. Set the option back to "false" to stop recording and start using the cached responses.


For further info on how this works, please see [Cypress autorecord](https://www.npmjs.com/package/cypress-autorecord) plugin docs.

```bash
npm run e2e:all -- -e report=true
```

### Bugs, features, feedback

Please use our issue tracker to report any bugs, request new features or ask questions.

That's it!
 